<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="project">
	
	<select id='getproject_seq' resultType="int">
		select project_seq.nextval from dual
	</select>
	
	<select id="checkCode" resultType="int">
		select count(*) from project where code=#{value}
	</select>
	
	<insert id="createProject">
		insert into project values(${seq},#{name},#{code},${leader_seq},${people_num})
	</insert>
	
	<insert id="insertProjectMember">
		insert into project_member values(project_member_seq.nextval,${project_seq},#{project_name},${member_seq},#{member_email},#{member_name},#{leader_yn},#{join_ynd})
	</insert>
	
	<select id="get_project_seq" resultType="int">
		select project_seq from project_member where member_seq=${value} and join_yn='y'
	</select>
	
	<select id="get_projectList" resultType="pcoop.backend.dto.ProjectDTO">
		select * from project where seq in
		<foreach collection="list" item="i" open="(" close=")" separator=",">
			${i}
		</foreach>
		order by seq
	</select>
	
	<select id="SelectMyProjectSeq" resultType="int">
		select seq from project_member where member_seq =${value} and leader_yn ='y'
	</select>
	
	<select id="SelectProjectMember" resultType="pcoop.backend.dto.ProjectMemberDTO">
		select * from project_member where seq=${value}
	</select>
	
	<select id="searchByCode" resultType="pcoop.backend.dto.ProjectDTO">
		select * from project where code=#{value}
	</select>
	
	<select id="joinCheck" resultType="String">
		select join_yn from project_member where project_seq=${project_seq} and member_seq=${member_seq}
	</select>
	
	<select id="selectBySeq" resultType="pcoop.backend.dto.ProjectDTO">
		select * from project where seq=${value}
	</select>
	
	<select id="joinYNcheck" resultType="pcoop.backend.dto.ProjectMemberDTO">
		select * from project_member where project_seq=${value} and join_yn='n'
	</select>
	
	<update id="accept">
		update project_member set join_yn='y', leader_yn='n' where project_seq=${project_seq} and member_seq=${mem_seq}
	</update>
	
	<select id="countPeople" resultType="int">
		select count(*) from project_member where project_seq=${value}
	</select>
	
	<select id="getPeople" resultType="int">
		select people_num from project where seq=${value}
	</select>
	
	<delete id="refuse">
		delete from project_member where project_seq=${project_seq} and member_seq=${mem_seq}
	</delete>
	
</mapper>